<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Two-way Authentication of Communicating Entities</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part548.htm">&lt; Назад</a><span> | </span><a href="../index.html">Содержимое</a><span> | </span><a href="part550.htm">Далее &gt;</a></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark547" name="bookmark2471">Two-way Authentication of Communicating Entities</a><a name="bookmark2561">&zwnj;</a></p><p style="padding-top: 5pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">A distributed system often distributes tasks over multiple nodes to achieve a higher throughput or more balanced utilization of distributed resources. Correctness of such a distributed task depends on whether peer processes participating in the task can identify each other correctly. Two-way authentication protocols allow both communicating entities to verify each other&#39;s identity before establishing a secure logical communication channel between them.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">Obviously,  a  protocol  can  implement  mutual  authentication  by  performing  one-way authentication twice. That is, if two communicating users <i>A </i>and <i>B </i>want to authenticate each other, <i>A </i>can first authenticate <i>B </i>by performing one-way authentication, and then <i>B </i>can authenticate <i>A </i>by repeating the same process, but with the roles of <i>A </i>and <i>B </i><a href="part548.htm#bookmark2559" class="s23">reversed. However, this protocol is costlier than a specially designed two-way authentication protocol. For example, if a two-way authentication protocol repeats the protocol of </a><a href="part548.htm#bookmark2559" class="s3">Figure </a><span class="s46">15.5</span> twice for performing mutual authentication of two communicating entities, it requires ten messages. However, a protocol for mutual authentication of communicating entities that requires only seven messages</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">is described here. It is also based on an asymmetric cryptosystem and uses a centralized AS. The description here assumes that two users <i>A </i>and <i>B </i>want to authenticate each other. <i>P</i><span class="s35">a </span>and <i>S</i><span class="s35">a </span>are the public and secret keys of user <i>A, P</i><span class="s35">b </span>and <i>S</i><span class="s35">b </span>are the public and secret keys of user <i>B, </i>and <i>P</i><span class="s35">s </span>and <i>S s </i><a href="part549.htm#bookmark2563" class="s23">are the public and secret keys of AS. The authentication protocol works as follows (see </a><a href="part549.htm#bookmark2563" class="s3">Figure </a><span class="s46">15.6</span>):</p><p class="s16" style="padding-top: 9pt;padding-left: 38pt;text-indent: -15pt;line-height: 109%;text-align: justify;"><span class="p">1. User </span>A <span class="p">sends a request message </span>(m<span class="s44">1</span>) <span class="p">to AS indicating that it wants to establish a secure logical communication channel with user </span>B. <span class="p">The message contains a code for the request </span>(R<span class="s35">a</span>), <span class="p">identifier of user </span>A (ID<span class="s35">a</span>), <span class="p">and identifier of user </span>B (ID<span class="s35">b</span>). <span class="p">It sends this message in</span></p><p style="padding-left: 38pt;text-indent: 0pt;line-height: 13pt;text-align: justify;">plaintext form.</p><p class="s16" style="padding-top: 4pt;padding-left: 39pt;text-indent: -15pt;text-align: justify;"><span class="p">2. On receiving </span>m<span class="s44">1</span>, <span class="p">AS extracts from its database the public key </span>P<span class="s35">b </span><span class="p">that corresponds to user identifier</span>ID<span class="s35">b </span><span class="p">of the message. By using its secret key</span>S<span class="s35">s</span>, <span class="p">AS encrypts the pair </span>(ID<span class="s35">b</span>, P<span class="s35">b</span>) <span class="p">to generate a ciphertext </span>C<span class="s35">1 </span><span class="p">=</span>E ((ID<span class="s35">b</span>, P<span class="s35">b</span>), S<span class="s35">s</span>). <span class="p">It then sends </span>C<span class="s35">1 </span><span class="p">to </span>A <span class="p">in a message </span>m<span class="s35">2</span><span class="p">.</span></p><p class="s16" style="padding-top: 4pt;padding-left: 39pt;text-indent: -15pt;text-align: justify;"><span class="p">3. On receiving </span>m<span class="s44">2</span><span class="p">, user </span>A <span class="p">decrypts </span>C<span class="s44">1</span> <span class="p">by using the public key of AS </span>(P<span class="s35">s</span>) <span class="p">and retrieves its contents. It then generates a random number </span>N<span class="s35">a</span>, <span class="p">encrypts the pair </span>(ID<span class="s35">a</span>, N<span class="s35">a</span>) <span class="p">by using the public key of user </span>B (P<span class="s35">b</span>) <span class="p">to generate a ciphertext </span>C<span class="s35">2 </span><span class="p">= </span>E ((ID<span class="s35">a</span>, N<span class="s35">a</span>), P<span class="s35">b</span>), <span class="p">and sends </span>C<span class="s35">2 </span><span class="p">to </span>B <span class="p">in a message </span>m<span class="s44">3</span>.</p><p class="s16" style="padding-top: 6pt;padding-left: 39pt;text-indent: -15pt;text-align: justify;"><span class="p">4. On receiving </span>m<span class="s44">3</span>, <span class="p">user </span>B <span class="p">decrypts </span>C<span class="s44">2</span> <span class="p">by using its secret key </span>S<span class="s35">b </span><span class="p">and retrieves its contents. It then sends a message </span>m<span class="s44">4</span> <span class="p">to AS requesting for the public key of user </span>A <span class="p">and a session key</span></p><p class="s16" style="padding-top: 2pt;padding-left: 39pt;text-indent: 0pt;text-align: justify;"><span class="p">for the secure logical communication channel between </span>A <span class="p">and</span>B. <span class="p">The message contains the request code </span>(R b), ID<span class="s35">a</span>, ID<span class="s35">b</span>, <span class="p">and </span>N<span class="s35">a</span>. <span class="p">Before sending the message, it encrypts it with the public key of AS</span>(P<span class="s35">s</span>). <span class="p">That is, the message contains the ciphertext</span>C<span class="s35">3 </span><span class="p">= </span>E ((R<span class="s35">b</span>, ID<span class="s35">a</span>, ID<span class="s35">b</span>, N<span class="s35">a</span>), P<span class="s35">s</span>).</p><p class="s16" style="padding-top: 3pt;padding-left: 39pt;text-indent: -15pt;line-height: 16pt;text-align: justify;"><span class="p">5. On receiving </span>m<span class="s44">4</span>, <span class="p">AS decrypts </span>C<span class="s44">3</span> <span class="p">with its secret key </span>(S<span class="s35">s</span>) <span class="p">and retrieves its contents. It generates a new session key </span>K <span class="p">for </span>A <span class="p">and </span>B. <span class="p">Next, it generates three ciphertexts: </span>C<span class="s44">4</span> <span class="p">= </span>E ((ID<span class="s35">a</span>, P<span class="s35">a</span>), S<span class="s35">s</span>), C<span class="s35">5 </span><span class="p">=</span>E ((ID<span class="s35">b</span>, K, N<span class="s35">a</span>), S<span class="s35">s</span>), <span class="p">and </span>C<span class="s35">6 </span><span class="p">= </span>E (C<span class="s35">5</span>, P<span class="s35">b</span>). <span class="p">Finally, it sends </span>C<span class="s35">4 </span><span class="p">and </span>C<span class="s35">6 </span><span class="p">to </span>B <span class="p">in a message </span>m<span class="s44">5</span>.</p><p class="s16" style="padding-top: 5pt;padding-left: 38pt;text-indent: -15pt;text-align: justify;"><span class="p">6. On receiving </span>m<span class="s35">5</span>, <span class="p">user </span>B <span class="p">decrypts </span>C<span class="s35">4 </span><span class="p">and </span>C<span class="s35">6 </span><span class="p">with </span>P<span class="s35">s </span><span class="p">and </span>S<span class="s35">b</span>, <span class="p">respectively, and retrieves their contents. It then generates a random number </span>N<span class="s35">b </span><span class="p">and creates a ciphertext </span>C<span class="s44">7</span> = E ((C<span class="s44">5</span>, N<span class="s35">b</span>), P<span class="s35">a</span>). <span class="p">Finally, it sends </span>C<span class="s35">7 </span><span class="p">to </span>A <span class="p">in a message </span>m<span class="s35">6</span>. <span class="p">It obtains </span>C<span class="s35">5 </span><span class="p">by decrypting </span>C<span class="s35">6</span>.</p><p class="s16" style="padding-top: 4pt;padding-left: 39pt;text-indent: -15pt;text-align: justify;"><span class="p">7. On receiving </span>m<span class="s35">6</span>, <span class="p">user </span>A <span class="p">first decrypts </span>C<span class="s35">7 </span><span class="p">by using its secret key </span>S<span class="s35">a </span><span class="p">and then decrypts </span>C<span class="s35">5 </span><span class="p">by using the public key of AS </span>(P<span class="s35">s</span>). <span class="p">Now both users </span>A <span class="p">and </span>B <span class="p">have the session key </span>K. <span class="p">User </span>A <span class="p">next generates a ciphertext</span>C<span class="s35">8 </span>= E (N<span class="s35">b</span>, K) <span class="p">and sends </span>C<span class="s35">8 </span><span class="p">to </span>B <span class="p">in a message </span>m<span class="s35">7</span>.</p><p class="s16" style="padding-top: 4pt;padding-left: 39pt;text-indent: -15pt;line-height: 109%;text-align: justify;"><a name="bookmark2562"><span class="p">8. On receiving </span></a>m<span class="s44">7</span><span class="p">, user </span>B <span class="p">decrypts </span>C<span class="s44">8</span> <span class="p">by using the session key </span>K, <span class="p">and compares the result with the original value of </span>N<span class="s35">b</span>. <span class="p">If they are equal, this is sufficient to prove that the logical communication channel established between </span>A <span class="p">and </span>B <span class="p">with key </span>K <span class="p">is a newly established</span></p><p style="padding-left: 39pt;text-indent: 0pt;line-height: 13pt;text-align: justify;">channel and is secure. Both users <i>A </i>and <i>B </i>are now sure of each other&#39;s identity.</p><p style="padding-left: 60pt;text-indent: 0pt;text-align: left;"><span><img width="480" height="357" alt="image" src="Image_808.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 4pt;padding-left: 195pt;text-indent: -180pt;text-align: left;"><a name="bookmark2563">Figure 15.6. </a><span class="s21">Two-way authentication protocol based on asymmetric cryptosystem and the use of a centralized authentication server.</span></p><p style="padding-top: 9pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">Notice that although the authentication protocol is based on an asymmetric cryptosystem, actual communications between users <i>A </i>and <i>B, </i>after the secure logical communication channel is established between them, take place by a symmetric cryptosystem.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part548.htm">&lt; Назад</a><span> | </span><a href="../index.html">Содержимое</a><span> | </span><a href="part550.htm">Далее &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
