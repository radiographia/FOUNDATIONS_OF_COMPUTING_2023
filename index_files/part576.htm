<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>SSL Record Protocol</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part575.htm">&lt; Назад</a><span> | </span><a href="../index.html">Содержимое</a><span> | </span><a href="part577.htm">Далее &gt;</a></p><p style="padding-top: 6pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark574" name="bookmark2498">SSL Record Protocol</a><a name="bookmark2623">&zwnj;</a></p><p style="padding-top: 5pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">SSL Record Protocol performs the following operations:</p><p style="padding-top: 9pt;padding-left: 39pt;text-indent: -15pt;text-align: justify;">1. <b>Fragmentation. </b>It first fragments an application message that SSL has to transmit securely (upper-layer message) into blocks of 2<span class="s22">14 </span>bytes (16384 bytes) or less.</p><p style="padding-top: 3pt;padding-left: 39pt;text-indent: -15pt;text-align: justify;">2. <b>Compression. </b>It then compresses the message by compressing each block separately. It uses lossless compression technique for this operation. The compression technique must be such that it does not increase the content length by more than 1024 bytes. Note that for short blocks, a compression algorithm provides longer output than the input because of formatting conventions. This is contrary to the general belief that compression always shrinks data size. This operation is optional. Moreover, the default compression algorithm in SSLv3 and TLS is null (no compression).</p><p style="padding-top: 4pt;padding-left: 39pt;text-indent: -15pt;text-align: justify;">3. <b>MAC addition. </b>It then computes a MAC (Message Authentication Code) for each compressed block and adds it to the compressed block data. It uses a shared secret key for this.</p><p style="padding-top: 4pt;padding-left: 39pt;text-indent: -15pt;text-align: justify;">4. <b>Encryption. </b>It then encrypts the compressed message plus the MAC using a symmetric encryption algorithm such as AES, IDEA, RC2-40, DES-40, DES, 3DES, Fortezza, RC4- 40, or RC4-128. The encryption operation should not increase the content length by more than 1024 bytes, so that the total size of a resulting block does not exceed 2 <span class="s22">14 </span>+ 2048 bytes (1024 for compression and 1024 for encryption).</p><p class="s46" style="padding-top: 3pt;padding-left: 38pt;text-indent: -15pt;text-align: justify;"><span class="p">5. </span><span class="s15">SSL record header appending. </span><a href="part576.htm#bookmark2624" class="s23">Finally, it prepends a 40 bits header to each block. The header has four fields (see </a>Figure 15.20<a href="part576.htm#bookmark2626" class="s23">). </a><a href="part576.htm#bookmark2626" class="s3">Figure </a>15.21<span class="s10"> </span><span class="p">shows the resulting record (block) format.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 60pt;text-indent: 0pt;text-align: left;"><span><img width="480" height="114" alt="image" src="Image_829.jpg"/></span></p><p class="s20" style="padding-top: 8pt;padding-left: 8pt;text-indent: 0pt;text-align: center;"><a name="bookmark2624">Figure 15.20. </a><span class="s21">Fields of a SSL record header.</span></p><p style="padding-left: 84pt;text-indent: 0pt;text-align: left;"><span><img width="417" height="202" alt="image" src="Image_830.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 4pt;padding-left: 8pt;text-indent: 0pt;text-align: justify;"><a name="bookmark2626">Figure 15.21. </a><span class="s21">SSL record (block) format after SSL Record Protocol operations are performed on a block of data.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part575.htm">&lt; Назад</a><span> | </span><a href="../index.html">Содержимое</a><span> | </span><a href="part577.htm">Далее &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
